# Queries for Studio Transport Management System

# List all transport requests (ordered by creation time)
query ListTransportRequests 
@auth(level: PUBLIC, insecureReason: "Dashboard needs to display all requests.") {
  transportRequests(orderBy: {createdAt: DESC}) {
    id
    passengerName
    department
    purpose
    phoneNumber
    employeeId
    pickupLocation
    dropLocation
    scheduledTime
    status
    priority
    createdAt
    updatedAt
    numberOfPassengers
    specialRequirements
    estimatedDistance
    requestType
    assignedVehicleId
    assignedVehicle {
      id
      vehicleNumber
      type
      model
      driverName
      driverPhone
      status
    }
  }
}

# Get a specific transport request by ID
query GetTransportRequestById($id: UUID!) 
@auth(level: PUBLIC, insecureReason: "Need to view individual requests.") {
  transportRequest(id: $id) {
    id
    passengerName
    department
    purpose
    phoneNumber
    employeeId
    pickupLocation
    dropLocation
    scheduledTime
    status
    priority
    createdAt
    updatedAt
    numberOfPassengers
    specialRequirements
    estimatedDistance
    requestType
    assignedVehicleId
    assignedVehicle {
      id
      vehicleNumber
      type
      model
      capacity
      driverName
      driverPhone
      status
      currentLocation
      imageUrl
    }
  }
}

# List all vehicles
query ListVehicles 
@auth(level: PUBLIC, insecureReason: "Fleet management needs to display all vehicles.") {
  vehicles(orderBy: {registeredAt: DESC}) {
    id
    vehicleNumber
    type
    model
    capacity
    driverName
    driverPhone
    driverLicense
    status
    currentLocation
    imageUrl
    registeredAt
    lastMaintenanceDate
  }
}

# Get available vehicles
query GetAvailableVehicles 
@auth(level: PUBLIC, insecureReason: "Dispatch needs to find available vehicles.") {
  vehicles(where: {status: {eq: "available"}}) {
    id
    vehicleNumber
    type
    model
    capacity
    driverName
    driverPhone
    status
    currentLocation
    imageUrl
  }
}

# Get a specific vehicle by ID
query GetVehicleById($id: UUID!) 
@auth(level: PUBLIC, insecureReason: "Need to view individual vehicles.") {
  vehicle(id: $id) {
    id
    vehicleNumber
    type
    model
    capacity
    driverName
    driverPhone
    driverLicense
    status
    currentLocation
    imageUrl
    registeredAt
    lastMaintenanceDate
  }
}

# List all dispatches
query ListDispatches 
@auth(level: PUBLIC, insecureReason: "Dispatch management needs to display all dispatches.") {
  dispatches(orderBy: {dispatchedAt: DESC}) {
    id
    requestId
    vehicleId
    dispatchedAt
    estimatedArrival
    actualArrival
    completedAt
    status
    notes
    dispatchedBy
    request {
      id
      passengerName
      pickupLocation
      dropLocation
      scheduledTime
    }
    vehicle {
      id
      vehicleNumber
      type
      driverName
      driverPhone
    }
  }
}
