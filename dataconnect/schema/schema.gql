# Schema for Studio Transport Management System

# Transport Request table
type TransportRequest @table {
  id: UUID! @default(expr: "uuidV4()")
  passengerName: String!
  department: String!
  purpose: String!
  
  # Contact information
  phoneNumber: String
  employeeId: String
  
  # Journey details
  pickupLocation: String!
  dropLocation: String!
  scheduledTime: Timestamp!
  
  # Request metadata
  status: String! @default(value: "pending") # pending, assigned, in_progress, completed, cancelled
  priority: String @default(value: "normal") # low, normal, high, urgent
  createdAt: Timestamp! @default(expr: "request.time")
  updatedAt: Timestamp! @default(expr: "request.time")
  
  # Relations - reference to vehicle
  assignedVehicleId: UUID
  assignedVehicle: Vehicle @ref(fields: "assignedVehicleId")
  
  # Additional fields
  specialRequirements: String
  numberOfPassengers: Int @default(value: 1)
  estimatedDistance: Float
  requestType: String # indoor, outdoor
}

# Vehicle table
type Vehicle @table {
  id: UUID! @default(expr: "uuidV4()")
  vehicleNumber: String! @unique
  type: String! # car, van, bus, ambulance, etc.
  model: String!
  capacity: Int!
  
  # Driver information
  driverName: String!
  driverPhone: String!
  driverLicense: String
  
  # Vehicle status
  status: String! @default(value: "available") # available, in_use, maintenance, offline
  currentLocation: String
  
  # Metadata
  imageUrl: String
  registeredAt: Timestamp! @default(expr: "request.time")
  lastMaintenanceDate: Timestamp
}

# Dispatch table - for tracking vehicle assignments
type Dispatch @table {
  id: UUID! @default(expr: "uuidV4()")
  
  # Request and vehicle references (non-nullable foreign keys)
  requestId: UUID!
  request: TransportRequest! @ref(fields: "requestId")
  vehicleId: UUID!
  vehicle: Vehicle! @ref(fields: "vehicleId")
  
  # Dispatch details
  dispatchedAt: Timestamp! @default(expr: "request.time")
  estimatedArrival: Timestamp
  actualArrival: Timestamp
  completedAt: Timestamp
  
  # Status tracking
  status: String! @default(value: "dispatched") # dispatched, en_route, arrived, completed, cancelled
  notes: String
  dispatchedBy: String # user who created the dispatch
}
